<div class="detailHead">
<span class="hedText">Section Details</span>
</div>
<div id="box">

</div>
<div class="boundDetail">    
    <table width=100%>
	    <th>Boundary Name</th>  <th>School Name</th>  <th>Class Name</th>  <th>Section Name</th>
	    <tr style="text-align:center;">
		<td>{{section.classname.sid.boundary}}</td>  <td>{{section.classname.sid}}</td>  <td>{{section.classname}}</td>  <td>{{section}}</td>
		
	    </tr>
	</table>
</div><br/>

<div class="detailHead">
<span class="hedText">Student Search</span>
</div>

<div class="detailHead">
    <form method='GET' action='/search/child/' id="searchForm" onsubmit="return false">
	<select name='fieldName' id='id_fieldName'>
		<option value='name'>First Name</option>
		<option value='dob'>Date of Birth (Year-month-date  2010-05-09)</option>
		<option value='gender'>Gender</option>
		<option value='mt'>Mother Tounge</option>
		<option value='mother'>mother Name</option>
		<option value='father'>Father Name</option>
	</select>
	<input type="hidden" name="section" id='id_section' value='{{section.id}}' />
	<input type="text" name="searchtext" id='id_searchtext' value='' />
	<input type="submit" name='search' value='submit' onclick="SearchData()"/>
    </form>

</div><br/>

<div  id="searchRes">
<div class="detailHead">
<span class="hedText">Student Details</span>
</div>

<div class="boundDetail">
	<table width=100%>
	    <th>First Name</th>  <th>Last Name</th>  <th>Date of Birth</th>  <th>Gender</th>  <th>Mother Tounge</th>  <th>Academic Year</th> <th>Question</th> <th>Marks</th> <th>Grade</th>
	    {% for i in section.getStudents%}
		<tr style="text-align:center;" id='student_{{i.id}}'>
			<td>{{i.name.firstName}}</td>
			<td>{{i.name.lastName}}</td>
			<td>{{i.name.dob}}</td>
			<td>{{i.name.gender}}</td>
			<td>{{i.name.mt}}</td>
			<td>{{i.academic}}</td>
			<td>
				<span id="{{i.id}}_student_question" style="{%if i.getStudentEval %}{% else %}display:none;{% endif %}">
					{{i.getStudentEval.question}}
				</span>
				<span id="{{i.id}}_ele_question" style="{%if i.getStudentEval %}display:none;{% else %}{% endif %}">
				<select name="question" id="{{i.id}}_id_question">
					{% for quest in i.getAssessmentQuestions %}
						{% if i.getStudentEval.question == quest %}
							<option value="{{quest.id}}" selected="True">{{quest}}</option>
						{% else %}
							<option value="{{quest.id}}">{{quest}}</option>
						{% endif %}
					{% endfor %}
				</select>
				</span>
			</td>
			<td>
				<span id="{{i.id}}_student_marks" style="{%if i.getStudentEval %}{% else %}display:none;{% endif %}">
					{{i.getStudentEval.marks}}
				</span>
				<span id="{{i.id}}_ele_marks" style="{%if i.getStudentEval %}display:none;{% else %}{% endif %}">
					<input type="text" name="marks" id="{{i.id}}_id_marks" size="3" value="{{i.getStudentEval.marks}}"/>
				</span>
			</td>
			<td>
				<span id="{{i.id}}_student_grade" style="{%if i.getStudentEval %}{% else %}display:none;{% endif %}">
					{{i.getStudentEval.grade}}
				</span>
				<span id="{{i.id}}_ele_grade" style="{%if i.getStudentEval %}display:none;{% else %}{% endif %}">
					<input type="text" name="grade" id="{{i.id}}_id_grade" size="3" value="{{i.getStudentEval.grade}}"/>
				</span>
			</td>
			<td>
				<input type="hidden" name="studEvalKey" id="{{i.id}}_studEvalKey" value="{{i.getStudentEval.id}}"/>
				<a id="{{i.id}}_save" onclick="return assignQuestion('{{i.id}}')" href="#" style="{%if i.getStudentEval %}display:none;{% else %}{% endif %}"> 
					Save
				</a>
			</td>
			<td>
				<a id="{{i.id}}_edit" onclick="return showFields('{{i.id}}')" href="#" style="{%if i.getStudentEval %}{% else %}display:none;{% endif %}"> 
					Edit
				</a>
			</td>
		</tr>
	    {% endfor %}
	</table>
</div>
</div>
<script>

function SearchData(){
        $.ajax({
            url: '/search/child/',
            data:'fieldName='+$("#id_fieldName").val()+'&section='+{{section.id}}+'&searchtext='+$("#id_searchtext").val(),
            success: function(data) {
                $('#searchRes').html(data);
            }
        });
	return false;
}

function showFields(studentId){
	$('#'+studentId+'_student_question').hide();
	$('#'+studentId+'_ele_question').show();
	$('#'+studentId+'_student_marks').hide();
	$('#'+studentId+'_ele_marks').show();
	$('#'+studentId+'_student_grade').hide();
	$('#'+studentId+'_ele_grade').show();
	$('#'+studentId+'_edit').hide();
	$('#'+studentId+'_save').show();
	return false;
}

function assignQuestion(studentId){
	    marks = $('#'+studentId+'_id_marks').val();
	    grade = $('#'+studentId+'_id_grade').val();
	    pk = $('#'+studentId+'_studEvalKey').val();
	    $.ajax({
            url: '/studentEvaluation/'+studentId+'/create/',
	    data: "question="+$('#'+studentId+'_id_question').val()+"&marks="+marks+"&grade="+grade+"&studEvalKey="+pk,
            success: function(data) {
		newData = data.split('&&')
                $('#'+studentId+'_student_question').html(newData[0]);
		$('#'+studentId+'_student_question').show();
		$('#'+studentId+'_ele_question').hide();
		$('#'+studentId+'_student_marks').html(marks);
		$('#'+studentId+'_student_marks').show();
		$('#'+studentId+'_ele_marks').hide();
		$('#'+studentId+'_student_grade').html(grade);
		$('#'+studentId+'_student_grade').show();
		$('#'+studentId+'_ele_grade').hide();
		$('#'+studentId+'_studEvalKey').val(newData[1]);
		$('#'+studentId+'_save').hide();
		$('#'+studentId+'_edit').show();
            }
        });
	return false;
	}
</script>

<!--div class="boundDetail"> 
    <span class=" gallery clearfix">   
        <a href="/sections/{{section.id}}/student/creator/" onclick="return schoolView(this)">
            Add Student
        </a> 
    </span>
</div-->    

