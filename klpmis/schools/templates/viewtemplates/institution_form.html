
{% load template_tags %}
<div class="detailHead">
<span class="hedText">{{extra_context|displayValue:'institutionType'}} Form</span>
</div>
<form action="." method="POST" enctype="multipart/form-data" id="institutionForm" onsubmit="return false;">{% csrf_token %}
    <input type="hidden" name="url" value="/boundary/{{extra_context|displayValue:'referKey'}}/institution/creator/" id="url" />
    <input type="hidden" name="form-buttonType" id="id_form-buttonType" value="save" />
    <input type="hidden" id="institution_id" size="15" value="{{extra_context|displayValue:'prevousId'}}" / >
    <input type="hidden" id="success_status" size="15" value="{{extra_context|displayValue:'showsuccess'}}" / >
    {{form.management_form}}
    {% with form.forms|last as entryForm %}
    <div>
        <label class="KLP_required">Name:</label>
        <input id="id_form-0-name" maxlength="300" name="form-0-name" tabindex="1" type="text" class="form-control">
         <!-- Name Field -->
        <!-- If Name field has errors show errors -->
        {% for error in entryForm.name.errors %}
            <span class="editErr">{{ error }}</span>
        {% endfor %}
        </br>
        <label>Category:</label>
        <select id="id_form-0-cat" name="form-0-cat" tabindex=2 class = "form-control">
        {% for category in extra_context|displayValue:'categoryList' %}
            {% if extra_context|displayValue:'selCategoryTyp' == category.id %}
                <option value="{{category.id}}" selected="true">{{category.name}}</option>

            {% else %}
                <option value="{{category.id}}">{{category.name}}</option>
            {% endif %}
        {% endfor %}
        </select>

        <!-- Category Field -->

        <div class="gallery clearfix">
            <span class="adNewBoundTyp">
                <a class="btn btn-default" href="/institution-category/creator/?keepThis=true&category_type={% if extra_context|displayValue:'institutionType'|lower == 'institution' %}1{% else %}2{% endif %}&TB_iframe=true&height=400&width=800" title="Create Category" class="thickbox">+</i></a>
            </span>
            <!-- If Category field has errors show errors -->
            {% for error in entryForm.cat.errors %}
                <span class="editErr">{{ error }}</span>
            {% endfor %}
            </br>
            <label class="KLP_required">{{extra_context|displayValue:'institutionType'}} Gender:</label>

            <!-- Institution Gender Field -->
            <select id="id_form-0-institution_gender" name="form-0-institution_gender" tabindex="3" class="form-control">
                <option value="boys">boys</option>
                <option value="girls">girls</option>
                <option value="co-ed" selected="selected">co-ed</option>
            </select>


            <!-- If Instituion Gender field has errors show errors -->
            {% for error in entryForm.institution_gender.errors %}
                <span class="editErr">{{ error }}</span>
            {% endfor %}
            </br>

            <label>Dise Code:</label>
            <!-- Dise Code Field -->
            <input id="id_form-0-dise_code" maxlength="14" name="form-0-dise_code" tabindex="4" type="text" class="form-control">
            <!-- If Dise Code field has errors show errors -->
            {% for error in entryForm.dise_code.errors %}
                <span class="editErr">{{ error }}</span>
            {% endfor %}
            </br>

            <label class="KLP_required">Language:</label>
            <!-- Language Field -->
            <select multiple="multiple" id="id_form-0-languages" name="form-0-languages" tabindex="5" class = "form-control">
                <option value="1">kannada</option>
                <option value="2">urdu</option>
                <option value="3">tamil</option>
                <option value="4">telugu</option>
                <option value="5">english</option>
                <option value="6">marathi</option>
                <option value="7">hindi</option>
                <option value="8">konkani</option>
                <option value="9">sindhi</option>
                <option value="10">other</option>
                <option value="11">gujarathi</option>
                <option value="12">not known</option>
                <option value="13">multi lng</option>
                <option value="14">nepali</option>
                <option value="15">oriya</option>
                <option value="16">bengali</option>
                <option value="17">malayalam</option>
                <option value="18">sanskrit</option>
            </select>

            <div class="gallery clearfix">
                <span class="adNewBoundTyp">
                    <a class="btn btn-default" class="thickbox" href="/language/creator/?keepThis=true&TB_iframe=true&height=400&width=800" title="Create Language">+</a>
                </span>
            </div>
                <!-- If Language field has errors show errors -->
                {% for error in entryForm.languages.errors %}
                    <span class="editErr">{{ error }}</span>
                {% endfor %}
                </br>

                <label class="KLP_required">Management:</label>
                <!-- Management Field -->
                <select id="id_form-0-mgmt" name="form-0-mgmt" tabindex="6" class="form-control">
                    <option value="1">ed</option>
                    <option value="2">swd</option>
                    <option value="3">local</option>
                    <option value="4">p-a</option>
                    <option value="5">p-ua</option>
                    <option value="6">others</option>
                    <option value="7">approved</option>
                    <option value="8">ssa</option>
                    <option value="9">kgbv</option>
                    <option value="10">p-a-sc</option>
                    <option value="11">p-a-st</option>
                    <option value="12">jawahar</option>
                    <option value="13">central</option>
                    <option value="14">sainik</option>
                    <option value="15">central govt</option>
                    <option value="16">nri</option>
                    <option value="17">madrasa-a</option>
                    <option value="18">madrasa-ua</option>
                    <option value="19">arabic-a</option>
                    <option value="20">arabic-ua</option>
                    <option value="21">sanskrit-a</option>
                    <option value="22">sanskrit-ua</option>
                    <option value="23">p-ua-sc</option>
                    <option value="24">p-ua-st</option>
                </select>
                <div class="gallery clearfix">
                    <span class="adNewBoundTyp">
                        <a class= "btn btn-default" class="thickbox" href="/institution-management/creator/?keepThis=true&TB_iframe=true&height=400&width=800" title="Create Management" >+</a>
                    </span>
                </div>

                <!-- If Management field has errors show errors -->
                {% for error in entryForm.mgmt.errors %}
                    <span class="editErr">{{ error }}</span>
                {% endfor %}
                </br>
                <label class="KLP_required">Address:</label>
                <input type="hidden" name="form-0-boundary" id="id_boundary" size="15" value='{{extra_context|displayValue:'referKey'}}'/>
                <!-- Address Field -->
                <input type="hidden" name="form-0-boundary" id="id_boundary" size="15" value='{{extra_context|displayValue:'referKey'}}'/>
                <textarea class="form-control" cols="20" id="id_form-0-address" name="form-0-address" rows="4" tabindex="7"></textarea>
                <!-- If address field has errors show errors -->
                {% for error in entryForm.address.errors %}
                    <span class="editErr">{{ error }}</span>
                {% endfor %}
                </br>

                <label>Area:</label>
                <!-- Area Field -->
                <textarea cols="20" id="id_form-0-area" name="form-0-area" rows="4" tabindex="8" class="form-control"></textarea>

                <!-- If area field has errors show errors -->
                {% for error in entryForm.area.errors %}
                    <span class="editErr">{{ error }}</span>
                {% endfor %}
                </br>

                <label>Pincode:</label>
                <!-- Pincode Field -->
                <input id="id_form-0-pincode" name="form-0-pincode" tabindex="9" type="text" class="form-control">

                <input type="hidden" name="form-0-active" id="id_form-0-active" value="2" />
                <!-- If pincode field has errors show errors -->
                {% for error in entryForm.pincode.errors %}
                    <span class="editErr">{{ error }}</span>
                {% endfor %}
                </br>

                <label>Landmark:</label>
                <!-- Landmark Field -->
                <textarea cols="20" id="id_form-0-landmark" name="form-0-landmark" rows="4" tabindex="10"class="form-control"></textarea>

                <!-- If landmark field has errors show errors -->
                {% for error in entryForm.landmark.errors %}
                    <span class="editErr">{{ error }}</span>
                {% endfor %}
                </br>

                <label>Identification:</label>
                <!-- Identification Field -->
                <input id="id_form-0-instidentification" name="form-0-instidentification" tabindex="11" type="text" class="form-control">

                <!-- If Identification field has errors show errors -->
                {% for error in entryForm.instidentification.errors %}
                    <span class="editErr">{{ error }}</span>
                {% endfor %}
                </br>

                <label>Route Information:</label>
                <!-- Route Information Field -->
                <input id="id_form-0-route_information" name="form-0-route_information" tabindex="11" type="text" class="form-control">

                <!-- If route_information field has errors show errors -->
                {% for error in entryForm.route_information.errors %}
                    <span class="editErr">{{ error }}</span>
                {% endfor %}
                </br>

                <button type="submit" name="save" id="id_save" value="Save" tabindex=10 class="btn btn-default">Save</button>
                <button type="submit" name="save_and_create" id="id_save_and_create" value="Save And Create Another" tabindex=11 class="btn btn-default">Save And Create Another</button>

        </div>
    </div>
    {% endwith %}
</form>


<script>
$(document).ready(function(){


   $("#id_save").click(function(){
    /* Clicking on save button hide all prv msgs and call form submit and pass button type is save */
    KLP_Hide_Msg();
    parentVal = $("#id_boundary").val();
    $("#id_form-buttonType").val('save');
    KLP_form_submit(parentVal);

   });

   $("#id_save_and_continue").click(function(){
    /* Clicking on save and continue button hide all prv msgs and call form submit and pass button type is save and continue */
    KLP_Hide_Msg();
    $("#id_form-buttonType").val('save and continue');
    parentVal = $("#id_boundary").val();
    KLP_form_submit(parentVal);
   });

   $("#id_save_and_create").click(function(){
    /* Clicking on save and add another button hide all prv msgs and call form submit and pass button type is save and add another */
    KLP_Hide_Msg();
    parentVal = $("#id_boundary").val();
    $("#id_form-buttonType").val('save and add another');
    KLP_form_submit(parentVal, 'id_boundary');


   });


   var KLP_form_submit = function(parentVal, parentId){
    /* post data using post method */
    $.post(
            $('#url').val(),
            $("#institutionForm").serialize(),
                function(data){
                     /* Get Response */
                    $("#dyncData").html(data);
                    // NFInit();
                    $('input:visible:enabled:first').focus();
                    var successStatus = $("#success_status").val();
                    if (successStatus == 'True'){
                        /* If It success show success msg and create new node in tree */
                        $("#successMsgHead").show();
                $("#klp_MsgTxt").html("{{extra_context|displayValue:'institutionType'}} Created Successfully")
                        if (parentId != null)
                            $("#"+parentId).val(parentVal);
                        ObjId='#boundary_'+parentVal
                        Obj=$(ObjId)
                        KLP_Create_Node(Obj,'institution');
                    }
               }
           );
   }

});
</script>